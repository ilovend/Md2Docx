# 功能清单

本文档列出Md2Docx的所有功能模块及其实现状态。

---

## 功能状态说明

| 状态      | 说明                   |
| :-------- | :--------------------- |
| ✅ 已完成 | 功能已实现并通过测试   |
| 🚧 开发中 | 功能正在开发           |
| 📋 已规划 | 功能已设计，待开发     |
| 💡 待评估 | 功能建议，需评估可行性 |

---

## 1. 主工作台 (Workspace)

| 功能            | 状态 | 优先级 | 说明                   |
| :-------------- | :--- | :----- | :--------------------- |
| 文件拖拽上传    | ✅   | P0     | 支持拖拽单个或多个文件 |
| 文件选择对话框  | ✅   | P0     | 点击按钮选择文件       |
| 文件夹递归扫描  | ✅   | P1     | 拖拽文件夹自动扫描文档 |
| 支持格式：.md   | ✅   | P0     | Markdown文件支持       |
| 支持格式：.docx | ✅   | P0     | Word文档支持           |
| 支持格式：.txt  | ✅   | P2     | 纯文本文件支持         |
| 预设快速选择    | ✅   | P0     | 下拉选择预设配置       |
| 严格模式开关    | 📋   | P1     | 启用更严格的修复规则   |
| 详细日志开关    | 📋   | P2     | 显示详细处理日志       |
| 后端状态监控    | ✅   | P0     | 显示连接状态和延迟     |
| 一键修复按钮    | ✅   | P0     | 启动文档处理流程       |

**界面原型**：[Workspace.tsx](file:///e:/ilovendProject/Md2Docx/frontend/src/pages/Workspace/index.tsx)

---

## 2. 规则配置编辑器 (Rule Editor)

| 功能              | 状态 | 优先级 | 说明                 |
| :---------------- | :--- | :----- | :------------------- |
| 规则树状导航      | ✅   | P0     | 左侧分类显示所有规则 |
| 规则分类展开/折叠 | 📋   | P1     | 点击分类展开内部规则 |
| 规则启用/禁用     | ✅   | P0     | 快速切换规则状态     |
| YAML语法高亮      | ✅   | P1     | 右侧编辑器语法高亮   |
| YAML格式验证      | 📋   | P1     | 实时验证配置语法     |
| 规则保存          | ✅   | P0     | 保存修改后的规则     |
| 规则测试          | ✅   | P1     | 在示例内容上测试效果 |
| 规则搜索          | 📋   | P2     | 按名称搜索规则       |
| 规则导入          | ✅   | P2     | 导入YAML规则文件     |
| 规则导出          | ✅   | P2     | 导出规则为YAML文件   |
| 新建规则          | 📋   | P1     | 创建自定义规则       |
| 删除规则          | 📋   | P2     | 删除自定义规则       |

**界面原型**：[RuleEditor.tsx](file:///e:/ilovendProject/Md2Docx/frontend/src/pages/RuleEditor/index.tsx)

---

## 3. 文档对比预览 (Comparison Preview)

| 功能           | 状态 | 优先级 | 说明                     |
| :------------- | :--- | :----- | :----------------------- |
| 左右分栏对比   | ✅   | P0     | 原始内容与修复后对比     |
| 修改高亮显示   | ✅   | P0     | 高亮显示所有修改点       |
| 修复摘要卡片   | ✅   | P0     | 显示修复统计信息         |
| 点击查看详情   | 📋   | P1     | 点击高亮区域查看详情     |
| 手动微调面板   | 📋   | P1     | 调整特定元素属性         |
| 实时预览       | 📋   | P1     | 调整时实时更新预览       |
| 应用单项修复   | 📋   | P1     | 单独应用某项修复         |
| 放弃单项修复   | 📋   | P1     | 放弃某项修复             |
| 撤销/重做      | 📋   | P2     | 操作历史管理             |
| 确认并下载     | ✅   | P0     | 确认修复并下载文档       |
| 文件重命名     | 📋   | P2     | 自定义输出文件名         |
| 修复摘要多语言 | 📋   | P2     | 修复原因支持多语言(i18n) |

**界面原型**：[ComparisonPreview.tsx](file:///e:/ilovendProject/Md2Docx/frontend/src/pages/ComparisonPreview/index.tsx)

---

## 4. 批量处理仪表盘 (Batch Processing)

| 功能           | 状态 | 优先级 | 说明                   |
| :------------- | :--- | :----- | :--------------------- |
| 文件列表表格   | ✅   | P0     | 显示所有待处理文件     |
| 文件状态指示   | ✅   | P0     | 显示处理状态图标       |
| 全局预设选择   | ✅   | P0     | 为所有文件选择预设     |
| 单文件预设覆盖 | ✅   | P1     | 为单个文件选择不同预设 |
| 开始/暂停处理  | ✅   | P0     | 控制批量处理流程       |
| 进度条显示     | ✅   | P0     | 显示整体处理进度       |
| 单文件进度     | ✅   | P1     | 显示每个文件的进度     |
| 删除文件       | ✅   | P1     | 从列表中移除文件       |
| 清空列表       | ✅   | P2     | 清空所有文件           |
| 错误处理       | ✅   | P1     | 显示处理失败的原因     |
| 批量下载       | ✅   | P0     | 打包下载所有结果 (Zip) |
| 优先级调整     | 📋   | P2     | 拖拽调整处理顺序       |
| 并行控制       | 📋   | P2     | 设置并行处理数量       |

**界面原型**：[BatchProcessing.tsx](file:///e:/ilovendProject/Md2Docx/frontend/src/pages/BatchProcessing/index.tsx)

---

## 5. 规则引擎功能

### 5.1 表格规则

| 规则           | 状态 | 优先级 | 说明               |
| :------------- | :--- | :----- | :----------------- |
| 表格边框修复   | ✅   | P0     | 统一边框样式       |
| 表头样式设置   | ✅   | P0     | 设置表头背景和字体 |
| 单元格间距调整 | ✅   | P1     | 调整内边距         |
| 列宽自适应     | 📋   | P1     | 根据内容调整列宽   |
| 表格居中       | 📋   | P2     | 页面居中对齐       |
| 跨页表头重复   | 📋   | P2     | 跨页时重复表头     |

### 5.2 公式规则

| 规则         | 状态 | 优先级 | 说明                |
| :----------- | :--- | :----- | :------------------ |
| LaTeX转OMML  | ✅   | P0     | 转换LaTeX为Word公式 |
| 公式编号     | 📋   | P1     | 添加/修复公式编号   |
| 行内公式样式 | 📋   | P1     | 调整行内公式字体    |
| 显示公式居中 | 📋   | P1     | 居中显示公式        |
| 公式引用     | 📋   | P2     | 自动更新公式引用    |

### 5.3 排版规则

| 规则         | 状态 | 优先级 | 说明             |
| :----------- | :--- | :----- | :--------------- |
| 标题样式统一 | ✅   | P0     | 规范化标题层级   |
| 段落间距     | ✅   | P0     | 设置段前段后间距 |
| 行间距       | ✅   | P0     | 调整行高         |
| 首行缩进     | ✅   | P1     | 设置中文缩进     |
| 字体替换     | 📋   | P1     | 替换非标准字体   |
| 标点规范化   | 📋   | P2     | 中英文标点转换   |

### 5.4 图表规则

| 规则         | 状态 | 优先级 | 说明              |
| :----------- | :--- | :----- | :---------------- |
| 图片尺寸调整 | 📋   | P1     | 限制最大宽度      |
| 图片居中     | ✅   | P1     | 居中对齐图片      |
| 图片标题     | 📋   | P1     | 添加"图X"标题     |
| Mermaid渲染  | 📋   | P2     | 将Mermaid转为图片 |
| 图表编号     | 📋   | P2     | 自动编号图表      |

---

## 6. 预设配置

| 预设                           | 状态 | 说明                                                  |
| :----------------------------- | :--- | :---------------------------------------------------- |
| 学术论文格式 (academic)        | ✅   | 内置预设：学术论文排版，包含表格/标题/缩进/公式等规则 |
| 竞标书标准 (bid)               | ✅   | 内置预设：竞标类文档的字体与版式规则                  |
| 企业公文规范 (business)        | ✅   | 内置预设：企业正式公文的字体与表格规范                |
| 全面配置 (comprehensive)       | ✅   | 内置预设：尽可能启用更多规则用于强力修复              |
| 默认配置 (default)             | ✅   | 内置预设：常用规则集合（兼容旧规则命名）              |
| 会议纪要格式 (meeting_minutes) | ✅   | 内置预设：会议纪要类文档的基础规范                    |
| 最小配置 (minimal)             | ✅   | 内置预设：仅启用少量必要规则                          |
| 企业标准 (Corporate)           | 📋   | 规划：更贴近商务报告的模板化预设                      |
| 学术论文 APA 7                 | 📋   | 规划：按 APA7 细则完善的专用预设                      |
| 技术博客                       | 📋   | 规划：技术文章/教程类预设                             |
| 法律文档                       | 📋   | 规划：合同/法律文书类预设                             |
| 自定义规则                     | 📋   | 规划：用户自定义组合与持久化                          |

---

## 7. 系统功能

| 功能     | 状态 | 优先级 | 说明         |
| :------- | :--- | :----- | :----------- |
| 深色主题 | ✅   | P0     | 默认深色界面 |
| 浅色主题 | 💡   | P3     | 可选浅色主题 |
| 中文界面 | ✅   | P0     | 中文UI文案   |
| 英文界面 | 💡   | P3     | 可选英文界面 |
| 操作历史 | ✅   | P2     | 查看历史任务 |
| 设置页面 | ✅   | P2     | 应用设置配置 |
| 快捷键   | 📋   | P3     | 键盘快捷操作 |
| 自动更新 | 💡   | P3     | 应用自动更新 |

---

## 8. 后端服务

| 功能          | 状态 | 优先级 | 说明              |
| :------------ | :--- | :----- | :---------------- |
| 文件上传接口  | ✅   | P0     | POST /api/upload  |
| 文档处理接口  | ✅   | P0     | POST /api/process |
| 文档下载接口  | ✅   | P0     | GET /api/download |
| 规则管理接口  | 📋   | P1     | CRUD /api/rules   |
| 预设管理接口  | ✅   | P1     | CRUD /api/presets |
| 批量处理接口  | ✅   | P1     | /api/batch/\*     |
| WebSocket通知 | ✅   | P2     | 实时进度推送      |
| 健康检查      | ✅   | P0     | GET /health       |

---

## 9. 开发路线图

### Phase 1: 核心功能 (MVP)

**目标**：实现基本的文档修复流程

- [x] 文件上传和解析
- [x] 表格边框修复规则
- [x] 标题样式规范化规则
- [x] 对比预览界面
- [x] 文档下载

**预计时间**：4周

### Phase 2: 规则引擎增强

**目标**：完善规则配置和管理

- [x] YAML规则编辑器
- [x] 规则测试功能
- [x] 预设配置管理
- [ ] 更多规则类型

**预计时间**：3周

### Phase 3: 批量处理

**目标**：支持多文件并行处理

- [x] 批量上传
- [x] 并行处理
- [x] 进度监控
- [x] 批量下载

**预计时间**：2周

### Phase 4: Electron集成

**目标**：打包为桌面应用

- [ ] Electron主进程
- [ ] 文件系统集成
- [ ] 后端进程管理
- [ ] 应用打包

**预计时间**：3周

### Phase 5: 高级功能

**目标**：企业级特性

- [x] LaTeX公式支持
- [ ] Mermaid图表渲染
- [x] 规则导入/导出
- [x] 操作历史

**预计时间**：4周

---

## 9.1 当前进度与下一步优先级

### P0

- 修改高亮的“点击查看详情”交互（对比预览：点击高亮区域弹出修复详情）
- 修复摘要多语言（i18n）

### P1

- YAML 格式验证（前端实时校验 + 友好错误提示）
- 规则管理接口（CRUD /api/rules）
- 图片尺寸调整（限制最大宽度）
- 图片标题（自动添加“图X”标题）

---

## 10. 功能请求

如果您有功能建议，请在GitHub Issues中使用"Feature Request"模板提交。

[提交功能请求](https://github.com/ilovend/md2docx/issues/new?template=feature_request.md)
